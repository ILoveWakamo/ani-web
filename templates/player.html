<!DOCTYPE html>
<html lang="en">

{% extends "base.html" %}
{% block title %} Episode {{ episode }} {% endblock %}
{% block head %} {{ super() }} {% endblock %}
{% block content %}
<h1>Episode {{ episode }}</h1>

<!-- ========================
     Custom Video Player
     ======================== -->
<div class="custom-player" id="playerContainer">

    <video id="video" autoplay>
        <source src="{{ mp4_link }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <div class="controls-bar">

        <!-- Play / Pause -->
        <button id="playPause" aria-label="Play/Pause">
            <svg viewBox="0 0 24 24" class="icon play">
                <polygon points="6,4 20,12 6,20"></polygon>
            </svg>
            <svg viewBox="0 0 24 24" class="icon pause hidden">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        </button>

        <!-- Rewind -->
        <button id="rewind" aria-label="Rewind 10 seconds">
            <svg viewBox="0 0 24 24" class="icon">
                <polygon points="11,18 3,12 11,6"></polygon>
                <polygon points="21,18 13,12 21,6"></polygon>
            </svg>
        </button>

        <!-- Forward -->
        <button id="forward" aria-label="Forward 10 seconds">
            <svg viewBox="0 0 24 24" class="icon">
                <polygon points="3,6 11,12 3,18"></polygon>
                <polygon points="13,6 21,12 13,18"></polygon>
            </svg>
        </button>

        <!-- Seek bar -->
        <input type="range" id="seekBar" value="0">
        <div id="timestamp">00:00</div>

        <div class="speed-control">
            <button id="speedBtn" aria-label="Playback speed">
                <svg viewBox="0 0 24 24" class="icon">
                    <circle cx="12" cy="12" r="9"></circle>
                    <line x1="12" y1="12" x2="17" y2="9"></line>
                </svg>
            </button>

            <div id="speedMenu" class="speed-menu">
                <button data-speed="0.5">0.5×</button>
                <button data-speed="1">1×</button>
                <button data-speed="1.25">1.25×</button>
                <button data-speed="1.5">1.5×</button>
                <button data-speed="2">2×</button>
            </div>
        </div>


        <!-- Fullscreen -->
        <button id="fullscreen" aria-label="Fullscreen">
            <svg viewBox="0 0 24 24" class="icon">
                <polyline points="4,9 4,4 9,4"></polyline>
                <polyline points="15,4 20,4 20,9"></polyline>
                <polyline points="20,15 20,20 15,20"></polyline>
                <polyline points="9,20 4,20 4,15"></polyline>
            </svg>
        </button>

    </div>
</div>

<!-- ========================
     Episode Navigation
     ======================== -->
<div class="controls">
    {% if episode > 1 %}
    <a href="{{ url_for('play', anime_id=anime_id) }}?episode={{ episode-1 }}&total={{ total_episodes }}">
        Previous Episode
    </a>
    {% endif %}

    {% if episode < total_episodes %} <a
        href="{{ url_for('play', anime_id=anime_id) }}?episode={{ episode+1 }}&total={{ total_episodes }}">
        Next Episode
        </a>
        {% endif %}

        <form method="GET" action="{{ url_for('play', anime_id=anime_id) }}">
            <label>Select Episode:</label>
            <select name="episode" onchange="this.form.submit()">
                {% for i in range(1, total_episodes + 1) %}
                <option value="{{ i }}" {% if i==episode %}selected{% endif %}>
                    Episode {{ i }}
                </option>
                {% endfor %}
            </select>
            <input type="hidden" name="total" value="{{ total_episodes }}">
        </form>
</div>

{% endblock %}
